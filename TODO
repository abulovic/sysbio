fix the weighted distribution calculation for smc
tryout the other model, get comparable results