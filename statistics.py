#!/usr/bin/python

import numpy as np
from scipy import linalg
import math
from itertools import izip

def covar(theta):
    X = np.vstack((theta))
    return np.cov(X)

def multi_mu(theta):
     mu = np.zeros(len(theta))
     for i in range(len(theta)):
         mu[i] = math.fsum(theta[i]) / len(theta[i])                             
     return mu

def mvnpdf(mu, Sigma, X):
    k = len(X)
    f = (1/(2 * np.pi)**(k/2) * linalg.det(Sigma)**0.5) * np.exp((-0.5 * (X - mu).T * linalg.inv(Sigma) * (X - mu)))
    return f

if __name__ == "__main__":
    th1 = [1.05121760677968, 1.10379162274823, 1.13494732443835, 1.03064808482406, 
           0.984588137331022, 0.880910954568547, 1.10228451983742, 0.983963400586106, 
           0.904022742397983, 0.93157680510325, 0.90662912115825, 0.98722000022997, 
           1.04117791901742, 1.15697905454352, 0.910501924551035, 1.15659152356517, 
           0.964724896192839, 1.03974295235938, 1.01851462359996, 0.871294900949271, 
           1.21363298387663, 1.05017151855642, 0.974837777023407, 0.86941585818281, 
           1.19323163617262, 1.17444941340896, 1.07994650448483, 1.07507934604983, 
           0.984878499191191, 0.941173001202628, 1.19130211331902, 0.980625599319019, 
           0.95404123412247, 1.07248168170107, 0.952828995014943, 0.909519018588209, 
           0.952151091899588, 0.976424823826654, 1.17670102982485, 1.06910658402528, 
           1.02902683290248, 1.03201028847278, 0.905944802438135, 0.986235472821804, 
           0.953344926153208, 1.06872506965722, 0.902580054116963, 1.04678524347518, 
           0.865669135516041, 0.968007827715308, 1.06352031708532, 0.969188987480067, 
           1.15129323341833, 1.16179993427707, 1.1092081195389, 0.962365847306959, 
           1.00500746542527, 1.13749933467497, 0.869865031369938, 1.10794583045674, 
           0.897992633796799, 1.09625679678199, 0.880940285181275, 1.19445187906225, 
           1.10420668254372, 1.11089027425598, 1.11879569679303, 0.931684281141228, 
           1.06797447913046, 0.951297189452687, 0.961224023311649, 0.940304923943669, 
           0.916015496016974, 1.02149651174747, 0.997205810823498, 1.2246840292129, 
           1.15301572037442, 1.00935750619539, 1.00610318647081, 1.13128299956781, 
           0.967365066814826, 1.09353849007246, 1.19470699743235, 1.2208735626485, 
           1.05530160842429, 0.889629953194227, 1.03070845036569, 0.932918694863606, 
           1.00898129376408, 1.03175876858439, 0.931209639972269, 0.878753592500868, 
           0.93027701410956, 1.05828110456677, 1.13372701200375, 0.911262449477018, 
           1.03023830204748, 1.06503670681764, 1.08781499896432, 0.923046908666953, 
           1.02685219108936, 0.973911637714235, 1.20135784401498, 1.06848383034006, 
           1.1371356141379, 0.861069986513336, 0.997488356566659, 0.983073627843865, 
           1.10629417350027, 1.08402280623842, 0.967519058664564, 0.867045453869028, 
           0.900071789255223, 0.905046843877032, 1.0387155210942, 0.895821426929881, 
           1.01248969727143, 0.882001757580493, 1.17569216326636, 1.03441559270981, 
           0.992222544921094, 0.953370957851346, 1.01880025645139, 1.02320684765657, 
           1.16844722885418, 1.12520857420387, 1.04965215748495, 1.02521704773084, 
           1.21869964838447, 1.18812444725496, 0.872212901938373, 1.04503811639789, 
           1.01739181287779, 1.15453035573379, 0.979851904062002, 1.04815624084051, 
           0.914293329317044, 0.982905614802473, 1.13243553967031, 1.08150935117246, 
           1.02151652277948, 1.20386781876841, 1.18937018965892, 1.04354083977265, 
           0.962027471346623, 1.14583082069553, 1.09199694367866, 0.909951593926443, 
           0.880762274867849, 0.930503960059577, 0.986063577246839, 1.04808205492867, 
           1.16626396453697, 0.859954680664282, 0.853612109765791, 1.08274927840971, 
           1.20470187659253, 1.05163116104504, 1.07113049685925, 0.921251337452821, 
           1.17622466268599, 0.962440857966158, 1.00408083855086, 1.04077611295242, 
           0.915977599732519, 0.915800027021268, 0.998865239013583, 1.15206232283444, 
           0.939952350855354, 1.11186947467225, 0.988188775086255, 0.955744369150556, 
           1.04089156376847, 1.18138295895048, 0.958329896392459, 1.14319302992885, 
           1.08510464680401, 1.14492340752096, 1.00169991678326, 0.93990041050049, 
           1.07291601551235, 1.12387780334171, 1.17094595387374, 0.885876158628809, 
           0.973148181258096, 0.991273221621409, 1.02534695369611, 1.12373752494652, 
           1.01563465627698, 0.982309711462385, 1.16638652053448, 0.936928763857835, 
           1.0275658174124, 1.07427906033578]
    th2 = [1.27851070976538, 0.887036385906682, 1.08475992314569, 1.18503779343664, 
           1.32085878029228, 0.938897660279133, 1.13213705417562, 0.815065679984471, 
           0.976602988602976, 1.14337754780289, 1.32078306511372, 1.42246705242166, 
           1.3541809932798, 1.04066468791268, 0.853961643354167, 0.77423354204387, 
           0.877375024506549, 0.806405404205207, 1.17923649200482, 1.12742657037458, 
           0.926833597440662, 1.27517286480907, 1.3390551192512, 1.0161140101937, 
           0.851026994770812, 0.838412847116187, 1.02999408511117, 0.93294214955569, 
           0.748153838305806, 0.889840882079904, 0.732477779680874, 0.868862808794249, 
           1.011648479215, 1.03294966356137, 1.32157995735134, 1.322238191771, 
           0.883772500042039, 1.37557189269691, 0.86093216903937, 1.13910707937562, 
           1.18135662460548, 1.1127418878851, 1.16729539732294, 1.18549282950805, 
           1.12297974981874, 0.841551003320108, 1.23306000429112, 1.12116236222344, 
           1.23060006886561, 1.23780583608978, 1.11530113443247, 0.932828892883779, 
           1.13043656348015, 0.883385570021751, 0.91550296274998, 1.41010842955161, 
           0.819644013128951, 0.976071092419939, 1.11984604826586, 0.901974879265794, 
           1.27839478566775, 0.704627084360112, 1.15005433589648, 0.801798580479034, 
           0.74864209955008, 0.906103378165318, 1.07672201612521, 1.22133716872847, 
           1.1659320975733, 1.32258512789984, 1.34787435577348, 1.06471204766709, 
           1.11076648493356, 1.09441638539973, 1.38009321668825, 0.744490399087436, 
           0.744214249872597, 0.843552330424792, 1.06592181127865, 0.889819841880555, 
           0.84223155665922, 0.710583753469654, 0.804568820982982, 0.738088107333152, 
           0.941771092091579, 1.27795008527655, 0.980411542040521, 1.08804837761142, 
           0.84101526253514, 1.10157597563362, 1.40537020290172, 1.25319455596545, 
           1.19930907939499, 1.16429021217766, 1.02730598992818, 0.968946443009996, 
           1.03306711458339, 0.966556013546982, 0.705534156842599, 0.895913161663398, 
           0.737722213062199, 1.17495665689382, 0.799029397896508, 0.85606418495273, 
           1.08342759568781, 1.22500681615302, 0.825250798508202, 1.0399691539153, 
           1.16249952565476, 1.12658663177863, 0.891527768507031, 1.07532874448155, 
           1.0086094268045, 1.11864532322467, 0.923961716291127, 1.31397574737305, 
           1.38153586010679, 0.912945880118552, 0.904466221729057, 1.14548612073319, 
           1.00738310947504, 1.31347428655493, 0.990768926604423, 1.14313134826841, 
           0.964077386228488, 1.09625266262389, 1.10180635954333, 1.29141208446141, 
           0.841031911523978, 0.767317408722507, 1.21306015747255, 1.33007102743215, 
           1.09935028960825, 0.855472479059215, 1.19156676266249, 0.952857457206372, 
           1.04995826808279, 1.17084510800474, 0.804233583885223, 1.0335260369612, 
           1.17053670498908, 0.770586183721663, 0.958497159319043, 1.2030404262436, 
           1.33641435022962, 1.06609295330743, 0.925619212049536, 1.34898844355995, 
           1.20195752218259, 1.32808034007471, 0.988889547688424, 1.16958852131348, 
           0.820153706707073, 1.10091967115796, 1.09394846751662, 0.957756420379752, 
           0.912777677545305, 1.12491164250705, 1.26466673147136, 0.875863890130796, 
           0.784497620767138, 1.28237819522501, 0.877382798700939, 1.28373325756649, 
           1.26233602408591, 0.911897012295056, 0.833128232091166, 0.775964173637773, 
           1.19363838302818, 0.755732883269613, 1.38146832688227, 0.796889708032593, 
           0.83496370155391, 0.894579195148271, 1.28699948985459, 0.994466521532601, 
           1.27770978865114, 0.834145454975442, 1.11196689366069, 1.08966955327202, 
           0.741541204381997, 0.779563212163566, 0.929911088298203, 1.2507712456312, 
           1.40527992461847, 0.88996300754906, 0.961207088359238, 0.832662711312212, 
           1.24854494828467, 1.34536352069514, 0.841103362291929, 1.10560486897274, 
           1.19101765801186, 0.770494884972833]

    
    cvr = covar([th1,th2])
    mu = multi_mu([th1,th2])
    X0 = np.array([1.0, 1.9])
    print mvnpdf(mu, cvr, X0)
